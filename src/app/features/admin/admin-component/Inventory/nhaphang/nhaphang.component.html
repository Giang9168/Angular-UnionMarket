<div class="filter-container mat-elevation-z1">
    <div class="filter-row">
  
      <mat-form-field appearance="outline">
        <mat-label>Từ</mat-label>
        <input matInput [matDatepicker]="fromPicker" [(ngModel)]="filter.fromDate">
        <mat-datepicker-toggle matSuffix [for]="fromPicker"></mat-datepicker-toggle>
        <mat-datepicker #fromPicker></mat-datepicker>
      </mat-form-field>
  
      <mat-form-field appearance="outline">
        <mat-label>Đến</mat-label>
        <input matInput [matDatepicker]="toPicker" [(ngModel)]="filter.toDate">
        <mat-datepicker-toggle matSuffix [for]="toPicker"></mat-datepicker-toggle>
        <mat-datepicker #toPicker></mat-datepicker>
      </mat-form-field>
  
      <mat-form-field appearance="outline" class="code-input">
        <mat-label>Mã c/t</mat-label>
        <input matInput [(ngModel)]="filter.code">
      </mat-form-field>
  
      <mat-form-field appearance="outline" class="search-field">
        <mat-label>Tìm kiếm...</mat-label>
        <input matInput [(ngModel)]="filter.search">
        <button matSuffix mat-icon-button color="primary" (click)="onSearch()">
          <mat-icon>search</mat-icon>
        </button>
      </mat-form-field>
  
      <button mat-raised-button color="primary" (click)="add()">
         Thêm mới 
      </button>
      
      <button mat-raised-button color="warn" (click)="approveSelected()">
        Duyệt đơn ({{ selectedCount }})
      </button>

      <button mat-raised-button color="warn" (click)="deleteSelectedByCode()" [disabled]="selectedCount === 0 ">
        Xóa đơn ({{ selectedCount }})
      </button>
      
    </div>
  
  </div>
  
  <div class="table-wrapper mat-elevation-z8">
  
    <table mat-table [dataSource]="dataSource" matSort>
  
      <ng-container matColumnDef="select">
        <th mat-header-cell *matHeaderCellDef>
          <mat-checkbox (change)="toggleAll($event)"></mat-checkbox>
        </th>
        <td mat-cell *matCellDef="let row">
          <mat-checkbox [(ngModel)]="row.isSelected" (change)="updateSelectedCount()"></mat-checkbox>
        </td>
      </ng-container>
  
      <ng-container matColumnDef="stt">
        <th mat-header-cell *matHeaderCellDef>Thứ tự</th>
        <td mat-cell *matCellDef="let row; let i = index">
          {{ i + 1 }}
        </td>
      </ng-container>
  
      <ng-container matColumnDef="code">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Mã</th>
        <td mat-cell *matCellDef="let row">{{ row.code }}</td>
      </ng-container>
  
      <ng-container matColumnDef="supplier">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Nhà cung cấp / Nhân viên</th>
        <td mat-cell *matCellDef="let row">{{ row.supplier }}</td>
      </ng-container>
  
      <ng-container matColumnDef="created">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Ngày tạo</th>
        <td mat-cell *matCellDef="let row">{{ row.created | date:'dd/MM/yyyy' }}</td>
      </ng-container>
  
      <ng-container matColumnDef="approved">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Ngày duyệt</th>
        <td mat-cell *matCellDef="let row">{{ row.approved | date:'dd/MM/yyyy' }}</td>
      </ng-container>
  
      <ng-container matColumnDef="quantity">
        <th mat-header-cell *matHeaderCellDef>SL</th>
        <td mat-cell *matCellDef="let row">{{ row.quantity }}</td>
      </ng-container>
  
      <ng-container matColumnDef="total">
        <th mat-header-cell *matHeaderCellDef>Tổng tiền</th>
        <td mat-cell *matCellDef="let row">{{ row.total | number }}</td>
      </ng-container>
  
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef>Trạng thái</th>
        <td mat-cell *matCellDef="let row">{{ row.status }}</td>
      </ng-container>
  
      <ng-container matColumnDef="note">
        <th mat-header-cell *matHeaderCellDef>Ghi chú</th>
        <td mat-cell *matCellDef="let row">{{ row.note }}</td>
      </ng-container>
  
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  
    </table>
  
    @if (dataSource.data.length === 0) {
       <div class="no-data">
       Không có bản ghi nào được tìm thấy
       </div>
      }
  
    <div class="summary-row">
      <span>Tổng cộng:</span>
      <span class="summary-value">{{ totalQuantity }}</span>
      <span class="summary-value">{{ totalMoney | number }}</span>
    </div>
  
  </div>
  
  <!-- Paginator -->
  <mat-paginator
    [length]="totalRecords"
    [pageSize]="pageSize"
    [pageSizeOptions]="[10,20,50]"
    showFirstLastButtons
    (page)="changePage($event)">
  </mat-paginator>
  